# 深圳房地产数据分析平台 (SZ-House)

## 1. 项目概述

**SZ-House** 是一个用于自动获取、存储和可视化深圳市房地产市场交易数据的全栈项目。它旨在为市场观察者、研究人员和潜在购房者提供及时、准确、透明的数据参考。

项目通过定时任务每日从深圳市住房和建设局官方API拉取新房和二手房的成交数据，进行处理和结构化存储，并提供了一个基于React的Web界面来直观地展示数据趋势。

## 2. 功能特性

- **自动化数据获取**: 每日自动从官方API获取新房和二手房的日度和月度成交数据。
- **结构化数据存储**: 将获取的数据以JSON格式按日期和类型清晰地存储在 `data` 目录中。
- **数据可视化**: 提供一个Web界面，通过图表展示历史成交趋势、区域对比等。
- **持续集成**: 利用GitHub Actions实现每日数据自动更新和代码提交，无需人工干预。
- **脚本化管理**: 提供NPM脚本，方便进行手动数据拉取、历史数据处理和数据摘要查看。

## 3. 技术栈

- **后端**: Node.js
- **前端**: React, Chart.js
- **自动化**: GitHub Actions
- **数据格式**: JSON

## 4. 项目结构

```
SZ_House/
├── .github/workflows/    # GitHub Actions 自动化工作流
│   └── fetch-data.yml    # 每日定时获取数据的脚本
├── data/                 # 存储抓取到的原始数据
│   ├── new_homes/        # 新房每日成交数据
│   ├── second_hand_homes/# 二手房每日成交数据
│   ├── new_homes_month/  # 新房每月成交数据
│   └── ...
├── src/                  # 后端Node.js源代码
│   ├── index.js          # 主入口文件，负责调度数据获取和处理
│   ├── get*.js           # 各类数据获取模块
│   └── process*.js       # 数据处理模块
├── ui/                   # 前端React应用
│   ├── src/              # React组件和业务逻辑
│   └── package.json      # 前端依赖
├── doc/                  # 项目文档
├── package.json          # 后端项目配置文件
└── README.md             # 本文档
```

## 5. 如何使用

### 5.1 后端 (数据获取)

1.  **安装依赖**:
    ```bash
    npm install
    ```

2.  **手动执行数据获取**:
    该命令会获取前一日和前一月的房产交易数据，并自动保存到 `data` 目录。
    ```bash
    npm start
    ```

### 5.2 前端 (数据可视化)

1.  **进入UI目录并安装依赖**:
    ```bash
    cd ui
    npm install
    ```

2.  **启动本地开发服务器**:
    应用将在 `http://localhost:3000` 上运行。
    ```bash
    npm start
    ```

## 6. NPM 脚本说明

项目根目录下的 `package.json` 定义了几个有用的脚本：

- `npm start`: 运行主要的数据获取任务。这是自动化流程的核心。
- `npm run summary`: 读取并展示当前数据的摘要信息。
- `npm run fix`: 用于处理和修复历史数据。

## 7. 自动化流程

本项目通过 **GitHub Actions** (`.github/workflows/fetch-data.yml`) 实现全自动化。

- **触发时机**: 每日 `21:00 UTC` (即北京时间次日上午5点) 自动运行。
- **执行流程**:
    1. 检出最新代码。
    2. 安装Node.js环境和项目依赖。
    3. 执行 `npm start` 命令获取最新数据。
    4. 检查 `data` 目录是否有变动。
    5. 如果有变动，则自动将更改提交 (commit) 并推送 (push) 到本仓库。

## 8. 数据来源

所有数据均来自 **深圳市住房和建设局** 的官方公开API。
